import{GAME_WIDTH,GAME_HEIGHT}from '../js/constants.js';const mockCanvas={width:GAME_WIDTH,height:GAME_HEIGHT,addEventListener:jest.fn(),getContext:jest.fn(()=>({clearRect:jest.fn(),fillRect:jest.fn(),beginPath:jest.fn(),arc:jest.fn(),fill:jest.fn(),createLinearGradient:jest.fn(()=>({addColorStop:jest.fn()})),fillStyle:'',strokeStyle:'',lineWidth:0}))};const mockScoreElement={textContent:'0'};let mockGameState='playing';describe('Breakout Game Physics',()=>{beforeAll(async()=>{global.canvas=mockCanvas;global.ctx=mockCanvas.getContext();global.scoreElement=mockScoreElement;global.gameState=mockGameState;global.score=0;const breakout=await import('../js/games/breakout.js');breakout.initBreakout(mockCanvas);breakout.resetBreakout();global.paddle=breakout.paddle;global.ball=breakout.ball;global.bricks=breakout.bricks;});test('Столкновение мяча со стенами',()=>{const initialVelocityX=ball.velocityX;const initialVelocityY=ball.velocityY;ball.x=GAME_WIDTH-ball.radius-1;ball.update();expect(ball.velocityX).toBe(-initialVelocityX);expect(ball.velocityY).toBe(initialVelocityY);ball.x=GAME_WIDTH/2;ball.y=ball.radius+1;ball.velocityX=initialVelocityX;ball.velocityY=initialVelocityY;ball.update();expect(ball.velocityX).toBe(initialVelocityX);expect(ball.velocityY).toBe(-initialVelocityY);});test('Столкновение мяча с платформой',()=>{ball.x=paddle.x+paddle.width/2;ball.y=paddle.y-ball.radius-1;ball.velocityX=0;ball.velocityY=5;const initialSpeed=ball.speed;ball.update();expect(ball.velocityY).toBeLessThan(0);expect(ball.velocityX).toBe(0);expect(ball.speed).toBe(initialSpeed);});test('Столкновение мяча с платформой под углом',()=>{ball.x=paddle.x+paddle.width/4;ball.y=paddle.y-ball.radius-1;ball.velocityX=0;ball.velocityY=5;ball.update();expect(ball.velocityX).toBeLessThan(0);expect(ball.velocityY).toBeLessThan(0);ball.x=paddle.x+paddle.width*3/4;ball.y=paddle.y-ball.radius-1;ball.velocityX=0;ball.velocityY=5;ball.update();expect(ball.velocityX).toBeGreaterThan(0);expect(ball.velocityY).toBeLessThan(0);});test('Столкновение мяча с кирпичом',()=>{bricks.init();const firstBrick=bricks.positions[0][0];ball.x=firstBrick.x+bricks.width/2;ball.y=firstBrick.y-ball.radius-1;ball.velocityX=0;ball.velocityY=5;const initialScore=parseInt(mockScoreElement.textContent);ball.update();bricks.update();expect(firstBrick.status).toBe(0);expect(parseInt(mockScoreElement.textContent)).toBe(initialScore+10);expect(ball.velocityY).toBeLessThan(0);});});