export function runDemo(container,level={}){const canvas=document.createElement('canvas');canvas.width=320;canvas.height=480;container.appendChild(canvas);const ctx=canvas.getContext('2d');const player={x:canvas.width/2,y:canvas.height-60,vy:0,w:24,h:24};const gravity=level.gravity || 0.6;const platforms=[];const speed=level.speed || 1.2;let running=true;const cols=6;for(let y=canvas.height;y>-2000;y-=80){const x=20+Math.random()*(canvas.width-40);platforms.push({x,y,w:60,h:10});}function update(){const modifiers=(level && level.modifiers)|| [];if(modifiers.includes('Дрейф платформ')){for(const p of platforms){p.x+=Math.random()*2-1;}}if(modifiers.includes('Туннельное зрение')&& Math.random()<0.005){}player.vy+=gravity;player.y+=player.vy;if(player.x<-player.w)player.x=canvas.width;if(player.x>canvas.width)player.x=-player.w;if(player.vy>0){for(const p of platforms){if(player.x+player.w>p.x && player.x<p.x+p.w && player.y+player.h>p.y && player.y+player.h<p.y+p.h+20){player.vy=-12;player.y=p.y-player.h-1;}}}if(player.y<canvas.height*0.4){const dy=(canvas.height*0.4-player.y);player.y+=dy;for(const p of platforms)p.y+=dy;}}function draw(){ctx.fillStyle='#071229';ctx.fillRect(0,0,canvas.width,canvas.height);ctx.fillStyle='#f4a';ctx.fillRect(player.x,player.y,player.w,player.h);ctx.fillStyle='#9fc';for(const p of platforms)ctx.fillRect(p.x,p.y,p.w,p.h);}function loop(){if(!running)return;update();draw();requestAnimationFrame(loop);}function onPointer(e){const rect=canvas.getBoundingClientRect();player.x=e.clientX-rect.left-player.w/2;}canvas.addEventListener('pointermove',onPointer);loop();return{stop(){running=false;canvas.removeEventListener('pointermove',onPointer);if(container.contains(canvas))container.removeChild(canvas);}};}